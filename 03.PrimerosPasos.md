# 3. Primeros Pasos, crear un pod <!-- omit in toc -->

> [Ver comandos mas utilizados (cheat Sheets)](https://kubernetes.io/docs/reference/kubectl/cheatsheet/)

> [Documentación Oficial](https://kubernetes.io/docs/concepts/workloads/pods/)

> [Ver los archivos demo](./assets)

# 1. Crear una carpeta con en nombre: labs
> En esta carpeta se crearán todos los archivos YAML (.yaml ó .yml) del proyecto

# 2. Crear un archivo con el nombre pod.yaml
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: myapp-pod
  labels:
    app: myapp
    type: frontend
spec:
  containers:
    - name: nginx-container
      image: nginx
```

## 2.1. Aplicar la definición del Pod y listar:

```
kubectl apply -f pod.yaml

kubectl get pods
```

El estado del Pod inicialmente aparece como ***ContainerCreating*** y unos segundos después: ***Running***

Resultado:
```
NAME        READY   STATUS    RESTARTS        AGE
myapp-pod   1/1     Running   1 (5m21s ago)   4d12h
```
# 3. Información del POD:
## 3.1. Mostrar etiquetas:
```
kubectl get pods --show-labels

```
## 3.2. Listar todos los PODs del cluster:

```
kubectl get pods --all-namespaces

kubectl get pods -A
```
## 3.3. Selector de etiquetas
```
kubectl get pods --selector=app=myapp
```
## 3.4. selector por campos
```
kubectl get pods --field-selector=status.phase=Running
```
## 3.5. Ver mas columnas (nodo + ip)
```
kubectl get pods -owide
```

## 3.6. Descripción detallada
```
kubectl describe pods myapp-pod
```
De la salida anterior, ver la información:
- Node
- Status
- IP
- Image ID
- Events

# 4. JSONPATH
[JSON PATH](https://kubernetes.io/docs/reference/kubectl/jsonpath/)
## 4.1. Instalar jq

```
sudo apt install -y jq

kubectl get pods -o=jsonpath='{.items[0]}'

kubectl get pods -o=jsonpath='{.items[0]}' | jq
```

# 5. Editar el pod.

> Este comando abre Vi en la terminal para editar la configuración actual del objeto

```
kubectl edit pod myapp-pod
```
Para guardar y salir de Vi
~~~~
Guardar ":w"

Guardar y salir ":wq"

Salir sin guardar ":q!"
~~~~

# 6. Eliminar el Pod:
```
kubectl delete pod myapp-pod
```
## 6.1. También es posible eliminar un objeto usuando archivos yaml
```
kubectl delete -f pod.yaml
```

# 7. Opcional. Comandos avanzados
## 7.1. Listar las IP

```
kubectl get pods -n kube-system -o custom-columns=NAME:metadata.name,IP:status.podIP
```

## 7.2. Eliminar todos los recursos de un cluster
kubectl delete "$(kubectl api-resources --namespaced=true --verbs=delete -o name | tr "\n" "," | sed -e 's/,$//')" --all


## 7.3. Ver Pods terminados:
```
kubectl get event -o custom-columns=NAME:.metadata.name | cut -d "." -f1
```
